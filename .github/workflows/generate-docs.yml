name: Generate Repository Documentation

on:
  workflow_call: {}

permissions:
  contents: write

jobs:
  generate-docs:
    runs-on: ubuntu-latest

    steps:
      - uses: actions/checkout@v4

      - name: Generate README.md
        run: |
          REPO=$(basename "$GITHUB_REPOSITORY")
          DATE=$(date +"%Y-%m-%d")
          echo "# $REPO" > README.md
          echo "" >> README.md
          echo "Auto-generated repository documentation." >> README.md
          echo "" >> README.md
          echo "Setup:" >> README.md
          echo "- git clone https://github.com/$GITHUB_REPOSITORY.git" >> README.md
          echo "- cd $REPO" >> README.md
          echo "- npm install" >> README.md
          echo "- npm run dev" >> README.md
          echo "" >> README.md
          echo "Generated on $DATE" >> README.md

      - name: Generate DEV_GUIDE.md
        run: |
          REPO=$(basename "$GITHUB_REPOSITORY")
          DATE=$(date +"%Y-%m-%d")
          echo "# Developer Guide - $REPO" > DEV_GUIDE.md
          echo "" >> DEV_GUIDE.md
          echo "Development Workflow:" >> DEV_GUIDE.md
          echo "- git checkout -b feature/name" >> DEV_GUIDE.md
          echo "- git commit -m 'feat: description'" >> DEV_GUIDE.md
          echo "- git push origin feature/name" >> DEV_GUIDE.md
          echo "" >> DEV_GUIDE.md
          echo "Testing:" >> DEV_GUIDE.md
          echo "- npm test" >> DEV_GUIDE.md
          echo "" >> DEV_GUIDE.md
          echo "Generated on $DATE" >> DEV_GUIDE.md

      - name: Commit documentation
        run: |
          git config user.name github-actions
          git config user.email github-actions@github.com
          git add README.md DEV_GUIDE.md
          git commit -m "docs: auto-generate documentation" || exit 0
          git push
