name: Generate Repository Documentation

on:
  workflow_call: {}

jobs:
  generate-docs:
    runs-on: ubuntu-latest

    steps:
      - uses: actions/checkout@v4

      - name: Generate README.md
        run: |
          REPO=$(basename "$GITHUB_REPOSITORY")
          DATE=$(date +"%Y-%m-%d")

          cat > README.md << EOF
# $REPO

Auto-generated repository documentation.

## Setup
\`\`\`bash
git clone https://github.com/$GITHUB_REPOSITORY.git
cd $REPO
npm install
npm run dev
\`\`\`

## Structure
- src/
- tests/
- docs/

Generated on $DATE
EOF

      - name: Generate DEV_GUIDE.md
        run: |
          REPO=$(basename "$GITHUB_REPOSITORY")
          DATE=$(date +"%Y-%m-%d")

          cat > DEV_GUIDE.md << EOF
# Developer Guide â€” $REPO

## Development Workflow
\`\`\`bash
git checkout -b feature/name
git commit -m "feat: description"
git push origin feature/name
\`\`\`

## Commit Convention
- feat: feature
- fix: bug
- docs: documentation
- refactor: refactor
- test: tests

## Testing
\`\`\`bash
npm test
npm run test:watch
\`\`\`

Generated on $DATE
EOF

      - name: Commit documentation
        run: |
          git config user.name github-actions
          git config user.email github-actions@github.com
          git add README.md DEV_GUIDE.md
          git commit -m "docs: auto-generate documentation" || exit 0
          git push
