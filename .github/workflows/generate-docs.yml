name: Generate Repository Documentation

on:
  workflow_call: {}

permissions:
  contents: write

jobs:
  generate-docs:
    runs-on: ubuntu-latest

    steps:
      - uses: actions/checkout@v4

      - name: Generate README.md
        run: |
          REPO=$(basename "$GITHUB_REPOSITORY")
          DATE=$(date +"%Y-%m-%d")

          printf "# %s\n\nAuto-generated repository documentation.\n\nSetup:\n- git clone https://github.com/%s.git\n- cd %s\n- npm install\n- npm run dev\n\nStructure:\n- src/\n- tests/\n- docs/\n\nGenerated on %s\n" \
          "$REPO" "$GITHUB_REPOSITORY" "$REPO" "$DATE" > README.md

      - name: Generate DEV_GUIDE.md
        run: |
          REPO=$(basename "$GITHUB_REPOSITORY")
          DATE=$(date +"%Y-%m-%d")

          printf "# Developer Guide â€” %s\n\nDevelopment Workflow:\n- git checkout -b feature/name\n- git commit -m \"feat: description\"\n- git push origin feature/name\n\nCommit Convention:\n- feat\n- fix\n- docs\n- refactor\n- test\n\nTesting:\n- npm test\n- npm run test:watch\n\nGenerated on %s\n" \
          "$REPO" "$DATE" > DEV_GUIDE.md

      - name: Commit documentation
        run: |
          git config user.name github-actions
          git config user.email github-actions@github.com
          git add README.md DEV_GUIDE.md
          git commit -m "docs: auto-generate documentation" || exit 0
          git push
